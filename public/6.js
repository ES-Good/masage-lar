(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"+Q0k":function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,"\n.filter-form[data-v-fb04a6d2]{\n    padding: 20px 10px;\n    background-color: #fafafa;\n}\n",""])},"8nix":function(e,t,n){"use strict";n.r(t);var r=n("o0o1"),a=n.n(r),i=n("7EX9");n("QRy/"),n("EHp8");function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}var c={name:"Journal",components:{DatePicker:i.default},data:function(){return{isLoad:!1,orders:{},name:null,phone:null,status:null,uniquePhone:!0,dateRange:[]}},watch:{uniquePhone:function(e){this.fetch()}},methods:{fetch:function(){var e,t=this;return(e=a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoad=!0,e.next=3,axios.get("/api/orders",{params:{name:t.name,phone:t.phone,status:t.status,date:t.dateRange}}).then((function(e){console.log(e.data.length),t.orders=t.uniquePhone?t.uniqueOrders(e.data):e.data,t.isLoad=!1}));case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){u(i,r,a,o,s,"next",e)}function s(e){u(i,r,a,o,s,"throw",e)}o(void 0)}))})()},filterStatus:function(e){return"new"===e?"Новый":"cancel"===e?"Отменен":void 0},uniqueOrders:function(e){return e.reduce((function(e,t){return e.find((function(e){return e.phone===t.phone}))?e:[].concat(o(e),[t])}),[])},uniqueOrdersDouble:function(){return this.orders.reduce((function(e,t){return Object.assign(e,(n={},r=t.phone,a=t,r in n?Object.defineProperty(n,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[r]=a,n));var n,r,a}),{})}},mounted:function(){var e=document.querySelectorAll("select");M.FormSelect.init(e);this.fetch()}},l=(n("jxXN"),n("KHd+")),d=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),0!==e.orders.length?n("div",{staticClass:"filter-form"},[n("b",[e._v("Фильтр")]),e._v(" "),n("form",[n("div",{staticClass:"row"},[n("div",{staticClass:"input-field col s2"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.status,expression:"status"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.status=t.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"",disabled:"",selected:""}},[e._v("Выбрать статус")]),e._v(" "),n("option",{attrs:{value:"new"}},[e._v("Новый")]),e._v(" "),n("option",{attrs:{value:"cancel"}},[e._v("Отменен")])]),e._v(" "),n("label",[e._v("Статус")])]),e._v(" "),n("div",{staticClass:"input-field col s4"},[n("date-picker",{attrs:{format:"YYYY-MM-DD",type:"date",range:"",placeholder:"Select date range"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),n("p",[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.uniquePhone,expression:"uniquePhone"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.uniquePhone)?e._i(e.uniquePhone,null)>-1:e.uniquePhone},on:{change:[function(t){var n=e.uniquePhone,r=t.target,a=!!r.checked;if(Array.isArray(n)){var i=e._i(n,null);r.checked?i<0&&(e.uniquePhone=n.concat([null])):i>-1&&(e.uniquePhone=n.slice(0,i).concat(n.slice(i+1)))}else e.uniquePhone=a},function(t){e.uniquePhone}]}}),e._v(" "),n("span",[e._v("Удалить дубликаты")])])]),e._v(" "),n("div",{staticClass:"input-field col s3"},[n("button",{staticClass:"btn waves-effect waves-light red",attrs:{type:"submit",name:"action"},on:{click:function(t){return t.preventDefault(),e.fetch(t)}}},[e._v("\n                       Применить\n                    ")])])])])]):e._e(),e._v(" "),e.isLoad?n("div",{staticClass:"progress red lighten-4"},[n("div",{staticClass:"indeterminate red"})]):e._e(),e._v(" "),n("section",[0===e.orders.length?n("h1",[e._v("Нет заявок")]):e._e(),e._v(" "),0!==e.orders.length?n("table",{staticClass:"responsive-table"},[e._m(1),e._v(" "),n("tbody",e._l(e.orders,(function(t,r){return n("tr",{key:r},[n("td",[e._v(e._s(++r))]),e._v(" "),n("td",[e._v(e._s(t.name))]),e._v(" "),n("td",[e._v(e._s(t.phone))]),e._v(" "),n("td",[n("span",{staticClass:"white-text badge red",class:{red:"cancel"===t.status,green:"new"===t.status}},[e._v(e._s(e.filterStatus(t.status)))])]),e._v(" "),n("td",[e._v("\n                "+e._s(e._f("date")(new Date(t.created_at),"datetime"))+"\n            ")])])})),0)]):e._e()])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"page-title"},[t("h3",[this._v("Журнал записей")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("#")]),e._v(" "),n("th",[e._v("Имя")]),e._v(" "),n("th",[e._v("Телефон")]),e._v(" "),n("th",[e._v("Статус")]),e._v(" "),n("th",[e._v("Дата создания")])])])}],!1,null,"fb04a6d2",null);t.default=d.exports},HUGP:function(e,t,n){var r=n("+Q0k");"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,a);r.locals&&(e.exports=r.locals)},jxXN:function(e,t,n){"use strict";n("HUGP")}}]);
//# sourceMappingURL=6.js.map